{% extends 'base.html' %}

{% load static %}

{% block content %}

<style>

  tr th { 
    position: sticky;
    top: 0;
  }

  @media screen and (max-width: 480px) {
    th{
      font-size: 10px;
    }

    td{
      font-size: 10px;
    }

  }
</style>

<div class="container-fluid">
    <br>
    <div class="row flex-nowrap">
        <main class="col ps-md-2 pt-2">
            <div class="row">

                {% if user.is_staff %}

                <br>
                <br>
                <h3 class="mb-3 text-center">Reporte de calificaciones Inngeniate-C</h3>

              <div class="col-12">
                <div class="container">
                  <br />
      
                  <div class="accordion" id="accordionPanelsStayOpenExample">
      
      
      
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingOne">
                        <button
                          class="accordion-button collapsed"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target="#panelsStayOpen-collapseOne"
                          aria-expanded="false"
                          aria-controls="panelsStayOpen-collapseOne"
                        >
                          <h5>
                            Categoría Clase avanzado (de 6to a 10vo semestre)
                          </h5>
                        </button>
                      </h2>
                      <div
                        id="panelsStayOpen-collapseOne"
                        class="accordion-collapse collapse"
                        aria-labelledby="panelsStayOpen-headingOne"
                      >
                        <div class="accordion-body">
                          
                            <div class="col-12">
                                <div class="container">
            
                                    <button id="btnExcelt1" type="button" class="btn btn-success">Exportar a Excel <i class="bi bi-file-earmark-excel"></i></button>
            
                                    <div class="row" style="overflow: auto; width: 100%; height: 70vh;">
                                        <table class="table" id="tableproyectost1">
                                            <thead>
                                              <tr>
                                                <th scope="col" style="text-align: center; background-color: white;">Proyecto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Autores</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Correo de contacto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Categoría</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota final</th>
            
                                              </tr>
                                            </thead>
                                            <tbody>
            
                                            
            
                                              {% for proyecto in reporte_proyecto %}
                                              
                                              {% if proyecto.categoria == 'Clase avanzado (de 6to a 10vo semestre)' %}
            
                                              <tr>
                                                
                                                <td>{{ proyecto.proyecto }}</td>
                                                <td>{{ proyecto.integrantes }}</td>
                                                <td>{{ proyecto.correo }}</td>
                                                <td>{{ proyecto.categoria }}</td>
                                                
                                                <td>
                                                    {{ proyecto.valoradores.0 }}
                                                </td>
            
                                                <td>
                                                    {% if not proyecto.notas.0 %} 
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.0 }}
                                                    {% endif %}
                                                </td>
            
                                                <td>
                                                    {{ proyecto.valoradores.1 }}
                                                </td>
            
                                                <td>{% if not proyecto.notas.1 %}  
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.1 }}
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    {{ proyecto.nota_final }}
                                                </td>
                            
                                              </tr>
            
                                              {% endif %}
            
                                              {% endfor %}
            
                                            </tbody>
                                          </table>
                                          <script>
                                            document.getElementById("btnExcelt1").addEventListener("click", function(){
                                            var table2excel = new Table2Excel();
                                            table2excel.export(document.querySelectorAll("#tableproyectost1"), "Clase_avanzado");
                                          });
                                        </script>
                                    </div>
                                </div>
                            </div>
      
                        </div>
                      </div>
                    </div>
      
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingTwo">
                        <button
                          class="accordion-button collapsed"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target="#panelsStayOpen-collapseTwo"
                          aria-expanded="false"
                          aria-controls="panelsStayOpen-collapseTwo"
                        >
                          <h5>
                           Categoría Clase básico (de 1er a 5to semestre)
                          </h5>
                        </button>
                      </h2>
                      <div
                        id="panelsStayOpen-collapseTwo"
                        class="accordion-collapse collapse"
                        aria-labelledby="panelsStayOpen-headingTwo"
                      >
                        <div class="accordion-body">
                            <div class="col-12">
                                <div class="container">
            
                                    <button id="btnExcelt2" type="button" class="btn btn-success">Exportar a Excel <i class="bi bi-file-earmark-excel"></i></button>
            
                                    <div class="row" style="overflow: auto; width: 100%; height: 70vh;">
                                        <table class="table" id="tableproyectost2">
                                            <thead>
                                              <tr>
                                                <th scope="col" style="text-align: center; background-color: white;">Proyecto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Autores</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Correo de contacto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Categoría</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota final</th>
            
                                              </tr>
                                            </thead>
                                            <tbody>
            
                                            
            
                                              {% for proyecto in reporte_proyecto %}
                                              
                                              {% if proyecto.categoria == 'Clase básico (de 1er a 5to semestre)' %}
            
                                              <tr>
                                                
                                                <td>{{ proyecto.proyecto }}</td>
                                                <td>{{ proyecto.integrantes }}</td>
                                                <td>{{ proyecto.correo }}</td>
                                                <td>{{ proyecto.categoria }}</td>
                                                
                                                <td>
                                                    {{ proyecto.valoradores.0 }}
                                                </td>
            
                                                <td>
                                                    {% if not proyecto.notas.0 %} 
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.0 }}
                                                    {% endif %}
                                                </td>
            
                                                <td>
                                                    {{ proyecto.valoradores.1 }}
                                                </td>
            
                                                <td>{% if not proyecto.notas.1 %}  
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.1 }}
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    <p>{{ proyecto.nota_final }}</p>
                                                </td>
                            
                                              </tr>
            
                                              {% endif %}
            
                                              {% endfor %}
            
                                            </tbody>
                                          </table>
                                          <script>
                                            document.getElementById("btnExcelt2").addEventListener("click", function(){
                                            var table2excel = new Table2Excel();
                                            table2excel.export(document.querySelectorAll("#tableproyectost2"), "Clase_basico");
                                          });
                                        </script>
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>
                    </div>
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingThree">
                        <button
                          class="accordion-button collapsed"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target="#panelsStayOpen-collapseThree"
                          aria-expanded="false"
                          aria-controls="panelsStayOpen-collapseThree"
                        >
                          <h5>Categoría Proyecto colegiados</h5>
                        </button>
                      </h2>
                      <div
                        id="panelsStayOpen-collapseThree"
                        class="accordion-collapse collapse"
                        aria-labelledby="panelsStayOpen-headingThree"
                      >
                        <div class="accordion-body">
                            <div class="col-12">
                                <div class="container">
            
                                    <button id="btnExcelt3" type="button" class="btn btn-success">Exportar a Excel <i class="bi bi-file-earmark-excel"></i></button>
            
                                    <div class="row" style="overflow: auto; width: 100%; height: 70vh;">
                                        <table class="table" id="tableproyectost3">
                                            <thead>
                                              <tr>
                                                <th scope="col" style="text-align: center; background-color: white;">Proyecto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Autores</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Correo de contacto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Categoría</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota final</th>
            
                                              </tr>
                                            </thead>
                                            <tbody>
            
                                              {% for proyecto in reporte_proyecto %}
                                              
                                              {% if proyecto.categoria == 'Proyecto colegiados' %}
            
                                              <tr>
                                                
                                                <td>{{ proyecto.proyecto }}</td>
                                                <td>{{ proyecto.integrantes }}</td>
                                                <td>{{ proyecto.correo }}</td>
                                                <td>{{ proyecto.categoria }}</td>
                                                
                                                <td>
                                                    {{ proyecto.valoradores.0 }}
                                                </td>
            
                                                <td>
                                                    {% if not proyecto.notas.0 %} 
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.0 }}
                                                    {% endif %}
                                                </td>
            
                                                <td>
                                                    {{ proyecto.valoradores.1 }}
                                                </td>
            
                                                <td>{% if not proyecto.notas.1 %}  
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.1 }}
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    {{ proyecto.nota_final }}
                                                </td>
                            
                                              </tr>
            
                                              {% endif %}
            
                                              {% endfor %}
            
                                            </tbody>
                                          </table>
                                          <script>
                                            document.getElementById("btnExcelt3").addEventListener("click", function(){
                                            var table2excel = new Table2Excel();
                                            table2excel.export(document.querySelectorAll("#tableproyectost3"), "Colegiados");
                                          });
                                        </script>
                                    </div>
                                </div>
                            </div>
                        </div>
                      </div>
                    </div>
                    <div class="accordion-item">
                      <h2 class="accordion-header" id="panelsStayOpen-headingFour">
                        <button
                          class="accordion-button collapsed"
                          type="button"
                          data-bs-toggle="collapse"
                          data-bs-target="#panelsStayOpen-collapseFour"
                          aria-expanded="false"
                          aria-controls="panelsStayOpen-collapseFour"
                        >
                          <h5>Categoría Proyecto de grado</h5>
                        </button>
                      </h2>
                      <div
                        id="panelsStayOpen-collapseFour"
                        class="accordion-collapse collapse"
                        aria-labelledby="panelsStayOpen-headingFour"
                      >
                        <div class="accordion-body">
                            <div class="col-12">
                                <div class="container">
            
                                    <button id="btnExcelt4" type="button" class="btn btn-success">Exportar a Excel <i class="bi bi-file-earmark-excel"></i></button>
            
                                    <div class="row" style="overflow: auto; width: 100%; height: 70vh;">
                                        <table class="table" id="tableproyectost4">
                                            <thead>
                                              <tr>
                                                <th scope="col" style="text-align: center; background-color: white;">Proyecto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Autores</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Correo de contacto</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Categoría</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota1</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Valorador2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota2</th>
                                                <th scope="col" style="text-align: center; background-color: white;">Nota final</th>
            
                                              </tr>
                                            </thead>
                                            <tbody>
            
                                              {% for proyecto in reporte_proyecto %}
                                              
                                              {% if proyecto.categoria == 'Proyecto de grado' %}
            
                                              <tr>
                                                
                                                <td>{{ proyecto.proyecto }}</td>
                                                <td>{{ proyecto.integrantes }}</td>
                                                <td>{{ proyecto.correo }}</td>
                                                <td>{{ proyecto.categoria }}</td>
                                                
                                                <td>
                                                    {{ proyecto.valoradores.0 }}
                                                </td>
            
                                                <td>
                                                    {% if not proyecto.notas.0 %} 
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.0 }}
                                                    {% endif %}
                                                </td>
            
                                                <td>
                                                    {{ proyecto.valoradores.1 }}
                                                </td>
            
                                                <td>{% if not proyecto.notas.1 %}  
                                                    <b style="color: red;">x</b> 
                                                    {% else %}
                                                    {{ proyecto.notas.1 }}
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    {{ proyecto.nota_final }}
                                                </td>
                            
                                              </tr>
            
                                              {% endif %}
            
                                              {% endfor %}
            
                                            </tbody>
                                          </table>
                                          <script>
                                            document.getElementById("btnExcelt4").addEventListener("click", function(){
                                            var table2excel = new Table2Excel();
                                            table2excel.export(document.querySelectorAll("#tableproyectost4"), "Proyecto_grado");
                                          });
                                        </script>
                                    </div>
                                </div>
                            </div>
                          
                      </div>
                      </div>
                    </div>
                  </div>
                  <br />
                </div>
              </div>

              {% endif %}  

            </div>
        </main>
    </div>
</div>

{% endblock %}